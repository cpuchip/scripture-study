import{d as R,o as G,c as l,a as t,t as i,w as p,v as _,b as g,e as M,F as w,r as S,f as A,g as H,h as J,n as y,i as d,j as $,k as h,l as r,m as Q,p as K,q as W,u as X}from"./index-B9Z8EGlb.js";const Y={class:"flex items-center justify-between mb-6"},Z={key:0,class:"bg-white rounded-lg shadow p-4 mb-6"},ee={class:"text-lg font-semibold mb-3"},te={class:"grid grid-cols-2 gap-4"},se={class:"flex gap-2"},oe=["disabled"],ae={key:0,class:"text-xs text-red-500 mt-1"},le={class:"flex gap-2 flex-wrap"},re=["onClick"],ie={class:"block text-sm font-medium text-gray-700 mb-1"},ne=["rows","placeholder"],de={key:0,class:"bg-indigo-50 rounded p-3 space-y-3"},ue={class:"flex items-center gap-2"},ce={key:1,class:"bg-gray-50 rounded p-3 space-y-3"},ge={class:"grid grid-cols-3 gap-3"},pe={class:"flex gap-2"},ve={type:"submit",class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm"},ye={key:1,class:"text-center py-8 text-gray-400"},xe={class:"mb-4 space-y-2"},me={class:"flex gap-1.5 flex-wrap items-center"},be=["onClick"],fe={key:0,class:"flex gap-1.5 flex-wrap items-center"},ke=["onClick"],_e={key:0,class:"text-center py-8 text-gray-400"},he={key:1,class:"bg-white rounded-lg shadow divide-y divide-gray-100"},we=["onClick"],Ce={class:"flex items-center gap-2"},Ne={class:"font-medium hover:text-indigo-600 transition-colors"},Pe={class:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600"},Se={key:0,class:"text-xs px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-600"},Te={key:0,class:"text-xs text-gray-400 truncate mt-0.5"},Ve={class:"flex items-center gap-2 ml-4"},$e=["onClick"],ze=["onClick"],Ue=["onClick"],De={key:3,class:"text-center py-12 text-gray-500"},Je=R({__name:"PracticesView",setup(Me){const z=X(),v=d([]),T=d(!0),x=d(!1),n=d(null),m=d("all"),b=d("all"),a=d({name:"",description:"",type:"habit",category:"",config:"{}"}),c=d({target_sets:2,target_reps:15,unit:"reps"}),f=d({target_daily_reps:1}),O=["spiritual","scripture","pt","fitness","study","health"],F=$(()=>{const o=new Set(v.value.map(e=>e.type));return Array.from(o).sort()}),U=$(()=>{const o=new Set(v.value.filter(e=>e.category).map(e=>e.category));return Array.from(o).sort()}),D=$(()=>v.value.filter(o=>!(m.value!=="all"&&o.type!==m.value||b.value!=="all"&&o.category!==b.value)));async function C(){T.value=!0,v.value=await h.listPractices(void 0,!1),T.value=!1}async function j(){const o={name:a.value.name,description:a.value.description,type:a.value.type,category:a.value.category};if(a.value.type==="tracker")o.config=JSON.stringify(c.value);else if(a.value.type==="memorize"){if(n.value!==null){const e=v.value.find(u=>u.id===n.value);if(e)try{const u=JSON.parse(e.config);u.target_daily_reps=f.value.target_daily_reps,o.config=JSON.stringify(u)}catch{o.config=e.config}}n.value||(o.config=JSON.stringify({target_daily_reps:f.value.target_daily_reps}))}else o.config="{}";if(n.value!==null){const e=v.value.find(u=>u.id===n.value);if(e){const u={...e,...o};await h.updatePractice(n.value,u)}}else await h.createPractice(o);V(),await C()}function V(){a.value={name:"",description:"",type:"habit",category:"",config:"{}"},c.value={target_sets:2,target_reps:15,unit:"reps"},f.value={target_daily_reps:1},n.value=null,x.value=!1}function B(o){if(n.value=o.id,a.value.name=o.name,a.value.description=o.description,a.value.type=o.type,a.value.category=o.category,a.value.config=o.config,o.type==="tracker"&&o.config)try{const e=JSON.parse(o.config);c.value={target_sets:e.target_sets??2,target_reps:e.target_reps??15,unit:e.unit??"reps"}}catch{}if(o.type==="memorize"&&o.config)try{const e=JSON.parse(o.config);f.value={target_daily_reps:e.target_daily_reps??1}}catch{}x.value=!0,window.scrollTo({top:0,behavior:"smooth"})}async function E(o){await h.updatePractice(o.id,{...o,active:!o.active}),await C()}async function L(o){confirm(`Delete "${o.name}" and all its logs?`)&&(await h.deletePractice(o.id),await C())}function q(o){o.type==="memorize"?z.push(`/memorize?id=${o.id}`):z.push(`/practices/${o.id}/history`)}const N=d(!1),P=d("");async function I(){if(a.value.name.trim()){N.value=!0,P.value="";try{const o=await h.lookupScripture(a.value.name.trim());o.verses&&o.verses.length>0&&(a.value.description=o.verses.map(e=>e.text).join(" "),o.verses.length===1&&(a.value.name=o.verses[0].reference))}catch(o){P.value=o.message||"Not found"}N.value=!1}}return G(C),(o,e)=>{const u=W("router-link");return r(),l("div",null,[t("div",Y,[e[11]||(e[11]=t("h1",{class:"text-2xl font-bold"},"Practices",-1)),t("button",{onClick:e[0]||(e[0]=s=>x.value?V():x.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm"},i(x.value?"Cancel":"+ Add Practice"),1)]),x.value?(r(),l("div",Z,[t("h2",ee,i(n.value?"Edit Practice":"New Practice"),1),t("form",{onSubmit:J(j,["prevent"]),class:"space-y-4"},[t("div",te,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Name",-1)),t("div",se,[p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.name=s),required:"",class:"flex-1 border rounded px-3 py-2 text-sm",placeholder:"Clamshell, D&C 93:29, Morning prayer..."},null,512),[[_,a.value.name]]),a.value.type==="memorize"?(r(),l("button",{key:0,type:"button",onClick:I,disabled:N.value||!a.value.name.trim(),class:"px-3 py-2 bg-indigo-100 text-indigo-700 rounded text-sm hover:bg-indigo-200 disabled:opacity-40 disabled:cursor-not-allowed whitespace-nowrap"},i(N.value?"...":"ðŸ“– Lookup"),9,oe)):g("",!0)]),P.value?(r(),l("p",ae,i(P.value),1)):g("",!0)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Type",-1)),p(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.type=s),class:"w-full border rounded px-3 py-2 text-sm"},[...e[13]||(e[13]=[t("option",{value:"habit"},"Habit (daily check)",-1),t("option",{value:"tracker"},"Tracker (sets/reps)",-1),t("option",{value:"memorize"},"Memorize (spaced repetition)",-1),t("option",{value:"task"},"Task (one-time)",-1)])],512),[[M,a.value.type]])])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category",-1)),t("div",le,[(r(),l(w,null,S(O,s=>t("button",{key:s,type:"button",onClick:k=>a.value.category=s,class:y(["px-3 py-1 text-xs rounded-full border",a.value.category===s?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-gray-50 border-gray-200 text-gray-600 hover:bg-gray-100"])},i(s),11,re)),64)),p(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.category=s),class:"px-3 py-1 text-xs border rounded-full w-28",placeholder:"custom..."},null,512),[[_,a.value.category]])])]),t("div",null,[t("label",ie,i(a.value.type==="memorize"?"Verse / Quote Text":"Description"),1),p(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.description=s),rows:a.value.type==="memorize"?4:2,class:"w-full border rounded px-3 py-2 text-sm",placeholder:a.value.type==="memorize"?"Man was also in the beginning with God. Intelligence, or the light of truth, was not created or made, neither indeed can be.":"Full verse text, exercise instructions, etc."},null,8,ne),[[_,a.value.description]])]),a.value.type==="memorize"?(r(),l("div",de,[e[18]||(e[18]=t("p",{class:"text-sm text-indigo-700"},[t("strong",null,"Tip:"),A(" Put the scripture reference as the Name (flashcard front). Put the full verse text in the Description (flashcard back). ")],-1)),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-xs text-indigo-600 mb-1"},"Daily practice goal",-1)),t("div",ue,[p(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>f.value.target_daily_reps=s),type:"number",min:"1",max:"20",class:"w-20 border rounded px-2 py-1 text-sm"},null,512),[[_,f.value.target_daily_reps,void 0,{number:!0}]]),e[16]||(e[16]=t("span",{class:"text-sm text-indigo-600"},"reviews per day",-1))])])])):g("",!0),a.value.type==="tracker"?(r(),l("div",ce,[e[23]||(e[23]=t("h3",{class:"text-sm font-medium text-gray-700"},"Tracker Settings",-1)),t("div",ge,[t("div",null,[e[19]||(e[19]=t("label",{class:"block text-xs text-gray-500"},"Target Sets",-1)),p(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>c.value.target_sets=s),type:"number",min:"1",class:"w-full border rounded px-2 py-1 text-sm"},null,512),[[_,c.value.target_sets,void 0,{number:!0}]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-xs text-gray-500"},"Target Reps",-1)),p(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>c.value.target_reps=s),type:"number",min:"1",class:"w-full border rounded px-2 py-1 text-sm"},null,512),[[_,c.value.target_reps,void 0,{number:!0}]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-xs text-gray-500"},"Unit",-1)),p(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>c.value.unit=s),class:"w-full border rounded px-2 py-1 text-sm"},[...e[21]||(e[21]=[H('<option value="reps">reps</option><option value="bottles">bottles</option><option value="glasses">glasses</option><option value="seconds">seconds</option><option value="minutes">minutes</option>',5)])],512),[[M,c.value.unit]])])])])):g("",!0),t("div",pe,[t("button",ve,i(n.value?"Save Changes":"Add Practice"),1),n.value?(r(),l("button",{key:0,type:"button",onClick:V,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 text-sm"}," Cancel ")):g("",!0)])],32)])):g("",!0),T.value?(r(),l("div",ye,"Loading...")):v.value.length>0?(r(),l(w,{key:2},[t("div",xe,[t("div",me,[e[24]||(e[24]=t("span",{class:"text-xs text-gray-400 w-10"},"Type",-1)),t("button",{onClick:e[9]||(e[9]=s=>m.value="all"),class:y(["px-2.5 py-1 text-xs rounded-full border",m.value==="all"?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-gray-50 border-gray-200 text-gray-500 hover:bg-gray-100"])},"all",2),(r(!0),l(w,null,S(F.value,s=>(r(),l("button",{key:s,onClick:k=>m.value=s,class:y(["px-2.5 py-1 text-xs rounded-full border",m.value===s?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-gray-50 border-gray-200 text-gray-500 hover:bg-gray-100"])},i(s),11,be))),128))]),U.value.length>1?(r(),l("div",fe,[e[25]||(e[25]=t("span",{class:"text-xs text-gray-400 w-10"},"Cat",-1)),t("button",{onClick:e[10]||(e[10]=s=>b.value="all"),class:y(["px-2.5 py-1 text-xs rounded-full border",b.value==="all"?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-gray-50 border-gray-200 text-gray-500 hover:bg-gray-100"])},"all",2),(r(!0),l(w,null,S(U.value,s=>(r(),l("button",{key:s,onClick:k=>b.value=s,class:y(["px-2.5 py-1 text-xs rounded-full border",b.value===s?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-gray-50 border-gray-200 text-gray-500 hover:bg-gray-100"])},i(s),11,ke))),128))])):g("",!0)]),D.value.length===0?(r(),l("div",_e," No practices match filters. ")):(r(),l("div",he,[(r(!0),l(w,null,S(D.value,s=>(r(),l("div",{key:s.id,class:y(["flex items-center justify-between px-4 py-3",{"opacity-50":!s.active}])},[t("div",{class:"min-w-0 flex-1 cursor-pointer",onClick:k=>q(s)},[t("div",Ce,[t("span",Ne,i(s.name),1),t("span",Pe,i(s.type),1),s.category?(r(),l("span",Se,i(s.category),1)):g("",!0)]),s.description?(r(),l("div",Te,i(s.description),1)):g("",!0)],8,we),t("div",Ve,[Q(u,{to:`/practices/${s.id}/history`,class:"text-xs text-gray-400 hover:text-indigo-500"},{default:K(()=>[...e[26]||(e[26]=[A(" history ",-1)])]),_:1},8,["to"]),t("button",{onClick:J(k=>B(s),["stop"]),class:"text-xs text-indigo-500 hover:text-indigo-700 px-2 py-1"}," edit ",8,$e),t("button",{onClick:k=>E(s),class:y(["text-xs px-2 py-1 rounded",s.active?"text-yellow-600 hover:bg-yellow-50":"text-green-600 hover:bg-green-50"])},i(s.active?"pause":"resume"),11,ze),t("button",{onClick:k=>L(s),class:"text-xs text-red-400 hover:text-red-600 px-2 py-1"}," delete ",8,Ue)])],2))),128))]))],64)):(r(),l("div",De," No practices yet. Add one above! "))])}}});export{Je as default};
