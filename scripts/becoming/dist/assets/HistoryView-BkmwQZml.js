import{d as M,o as R,c as o,m as T,p as F,a as e,t as n,b as c,F as D,r as k,s as P,i as f,j as _,k as S,q as z,l,f as H,x as U,n as q}from"./index-B9Z8EGlb.js";const A={key:0,class:"text-center py-8 text-gray-400"},E={key:1},I={class:"flex items-center gap-3 mb-6"},J={class:"text-2xl font-bold"},O={class:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600"},Y={key:0,class:"text-xs px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-600"},G={key:0,class:"text-sm text-gray-600 mb-6"},K={class:"grid grid-cols-3 gap-4 mb-6"},Q={class:"bg-white rounded-lg shadow p-4 text-center"},W={class:"text-2xl font-bold text-indigo-600"},X={class:"bg-white rounded-lg shadow p-4 text-center"},Z={class:"text-2xl font-bold text-green-600"},tt={class:"bg-white rounded-lg shadow p-4 text-center"},et={class:"text-2xl font-bold text-amber-600"},st={class:"bg-white rounded-lg shadow p-4 mb-6"},at={class:"flex items-end gap-px h-32"},nt=["title"],ot={class:"flex justify-between mt-1 text-[10px] text-gray-400"},lt={class:"bg-white rounded-lg shadow"},rt={class:"divide-y divide-gray-100"},it={class:"text-gray-600"},ct={class:"flex items-center gap-3 text-gray-500 text-xs"},dt={key:0},ut={key:1},gt={key:2},xt={key:3,class:"text-gray-400 italic truncate max-w-48"},vt={key:0,class:"px-4 py-6 text-center text-gray-400 text-sm"},h=30,ht=M({__name:"HistoryView",setup(pt){const L=P(),b=Number(L.params.id),r=f(null),d=f([]),m=f(!0);function p(s=new Date){return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`}function w(){const s=new Date,a=new Date;return a.setDate(a.getDate()-h),{start:p(a),end:p(s)}}const u=_(()=>{const s=w(),a=[],t=(r.value?V(r.value.config):{}).target_sets||1,v={};for(const x of d.value)v[x.date]=(v[x.date]||0)+(x.sets||1);const g=new Date(s.start+"T12:00:00"),y=new Date(s.end+"T12:00:00");for(;g<=y;){const x=p(g);a.push({date:x,label:g.toLocaleDateString("en-US",{month:"short",day:"numeric"}),value:v[x]||0,target:r.value?.type==="tracker"?t:1}),g.setDate(g.getDate()+1)}return a}),N=_(()=>Math.max(...u.value.map(s=>Math.max(s.value,s.target)),1)),$=_(()=>{let s=0;const a=new Date;for(let i=0;i<365;i++){const t=new Date(a);t.setDate(t.getDate()-i);const v=p(t);if(d.value.some(y=>y.date===v))s++;else if(i>0)break}return s}),C=_(()=>d.value.length);function V(s){try{return JSON.parse(s)}catch{return{}}}function B(s){return new Date(s+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}async function j(){m.value=!0;const s=w(),[a,i]=await Promise.all([S.getPractice(b),S.listPracticeLogsRange(b,s.start,s.end)]);r.value=a,d.value=i,m.value=!1}return R(j),(s,a)=>{const i=z("router-link");return l(),o("div",null,[T(i,{to:"/",class:"text-sm text-gray-400 hover:text-indigo-500 mb-4 inline-block"},{default:F(()=>[...a[0]||(a[0]=[H(" â† Back to today ",-1)])]),_:1}),m.value?(l(),o("div",A,"Loading...")):r.value?(l(),o("div",E,[e("div",I,[e("h1",J,n(r.value.name),1),e("span",O,n(r.value.type),1),r.value.category?(l(),o("span",Y,n(r.value.category),1)):c("",!0)]),r.value.description?(l(),o("p",G,n(r.value.description),1)):c("",!0),e("div",K,[e("div",Q,[e("div",W,n($.value),1),a[1]||(a[1]=e("div",{class:"text-xs text-gray-500"},"day streak",-1))]),e("div",X,[e("div",Z,n(C.value),1),e("div",{class:"text-xs text-gray-500"},"total logs ("+n(h)+"d)")]),e("div",tt,[e("div",et,n(u.value.filter(t=>t.value>=t.target).length),1),a[2]||(a[2]=e("div",{class:"text-xs text-gray-500"},"days completed",-1))])]),e("div",st,[e("h2",{class:"text-sm font-semibold text-gray-700 mb-3"},"Last "+n(h)+" Days"),e("div",at,[(l(!0),o(D,null,k(u.value,t=>(l(),o("div",{key:t.date,class:"flex-1 flex flex-col items-center justify-end",title:`${t.label}: ${t.value}/${t.target}`},[e("div",{class:q(["w-full rounded-t transition-all",t.value>=t.target?"bg-green-400":t.value>0?"bg-amber-300":"bg-gray-100"]),style:U({height:`${t.value/N.value*100}%`,minHeight:t.value>0?"4px":"2px"})},null,6)],8,nt))),128))]),e("div",ot,[e("span",null,n(u.value[0]?.label),1),e("span",null,n(u.value[u.value.length-1]?.label),1)])]),e("div",lt,[a[3]||(a[3]=e("h2",{class:"text-sm font-semibold text-gray-700 px-4 pt-4 pb-2"},"Recent Activity",-1)),e("div",rt,[(l(!0),o(D,null,k([...d.value].reverse().slice(0,20),t=>(l(),o("div",{key:t.id,class:"px-4 py-2 flex items-center justify-between text-sm"},[e("span",it,n(B(t.date)),1),e("div",ct,[t.sets?(l(),o("span",dt,n(t.sets)+" sets",1)):c("",!0),t.reps?(l(),o("span",ut,n(t.reps)+" reps",1)):c("",!0),t.value?(l(),o("span",gt,n(t.value),1)):c("",!0),t.notes?(l(),o("span",xt,n(t.notes),1)):c("",!0)])]))),128)),d.value.length===0?(l(),o("div",vt," No activity yet in the last "+n(h)+" days. ")):c("",!0)])])])):c("",!0)])}}});export{ht as default};
